{
  "meta": {
    "name": "gentle_slalom_pid_xcmg_v2",
    "version": 2,
    "description": "XCMG XDE360 (220-ton) - Optimized PID with brake conversion",
    "control_mode": "velocity_pid"
  },
  "timing": {
    "dt_s": 0.01,
    "duration_s": 120.0,
    "log_hz": 10.0,
    "real_time_mode": true
  },
  "pid_config": {
    "target_velocity_mps": 5.5,
    "kp": 15000.0,
    "ki": 800.0,
    "kd": 3000.0,
    "max_torque_nm": 250000.0,
    "min_torque_nm": -145000.0,
    "integral_limit": 5000.0
  },
  "defaults": {
    "system_enable": true,
    "mode": 0,
    "drive_torque_cmd_nm": 0.0,
    "brake_cmd_pct": 0.0,
    "steer_cmd_deg": 0.0
  },
  "segments": [
    {
      "t0": 0.0,
      "t1": 15.0,
      "steer_cmd_deg": 0.0,
      "comment": "Straight acceleration to 12 m/s"
    },
    {
      "t0": 15.0,
      "t1": 25.0,
      "steer_cmd_deg": 5.0,
      "comment": "Gentle right turn"
    },
    {
      "t0": 25.0,
      "t1": 35.0,
      "steer_cmd_deg": -5.0,
      "comment": "Gentle left turn"
    },
    {
      "t0": 35.0,
      "t1": 45.0,
      "steer_cmd_deg": 5.0,
      "comment": "Right turn"
    },
    {
      "t0": 45.0,
      "t1": 55.0,
      "steer_cmd_deg": -5.0,
      "comment": "Left turn"
    },
    {
      "t0": 55.0,
      "t1": 65.0,
      "steer_cmd_deg": 5.0,
      "comment": "Right turn"
    },
    {
      "t0": 65.0,
      "t1": 75.0,
      "steer_cmd_deg": -5.0,
      "comment": "Left turn"
    },
    {
      "t0": 75.0,
      "t1": 85.0,
      "steer_cmd_deg": 5.0,
      "comment": "Right turn"
    },
    {
      "t0": 85.0,
      "t1": 95.0,
      "steer_cmd_deg": -5.0,
      "comment": "Left turn"
    },
    {
      "t0": 95.0,
      "t1": 105.0,
      "steer_cmd_deg": 5.0,
      "comment": "Final right"
    },
    {
      "t0": 105.0,
      "t1": 115.0,
      "steer_cmd_deg": -5.0,
      "comment": "Final left"
    },
    {
      "t0": 115.0,
      "t1": 150.0,
      "steer_cmd_deg": 0.0,
      "comment": "Straighten"
    }
  ],
  "tuning_notes": {
    "description": "PID tuning for XCMG XDE360 220-ton electric mining truck",
    "vehicle_params": {
      "mass_kg": 220000,
      "max_motor_torque_nm": 145000,
      "max_brake_force_n": 180000,
      "wheel_radius_m": 1.95,
      "gear_ratio": 28.0
    },
    "gains_rationale": {
      "kp": "Tripled to 15000 - Heavy trucks need strong proportional response",
      "ki": "Increased to 800 - Handle sustained drag/rolling resistance",
      "kd": "Tripled to 3000 - Critical for damping 220-ton inertia",
      "integral_limit": "Reduced to 30000 - Prevent excessive windup"
    },
    "brake_conversion_required": {
      "condition": "When PID outputs negative torque",
      "formula": "brake_pct = abs(torque_nm) / max_brake_torque_equivalent * 100",
      "max_brake_torque_equivalent": "brake_force_n * wheel_radius_m / gear_ratio = 180000 * 1.95 / 28 = 12536 Nm",
      "example": "If PID = -10000 Nm, brake = 10000/12536*100 = 79.8%",
      "critical": "Must set drive_torque_cmd_nm = 0 when braking!"
    }
  }
}